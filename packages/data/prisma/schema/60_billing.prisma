model Invoice {
  id          String        @id @default(cuid())
  tenantId    String
  customerId  String
  number      String?
  status      InvoiceStatus @default(DRAFT)
  currency    String
  notes       String?
  terms       String?
  invoiceDate DateTime?     @db.Date
  dueDate     DateTime?     @db.Date
  issuedAt    DateTime?     @db.Timestamptz(6)
  sentAt      DateTime?     @db.Timestamptz(6)
  createdAt   DateTime      @default(now()) @db.Timestamptz(6)
  updatedAt   DateTime      @updatedAt @db.Timestamptz(6)

  lines     InvoiceLine[]
  payments  InvoicePayment[]

  @@index([tenantId, status])
  @@index([tenantId, createdAt])
  @@unique([tenantId, number])
}

model InvoiceLine {
  id             String   @id @default(cuid())
  invoiceId      String
  description    String
  qty            Int
  unitPriceCents Int

  invoice Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
}

model InvoicePayment {
  id          String   @id @default(cuid())
  invoiceId   String
  amountCents Int
  paidAt      DateTime @db.Timestamptz(6)
  note        String?

  invoice Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
}

enum InvoiceStatus {
  DRAFT
  ISSUED
  SENT
  PAID
  CANCELED
}
